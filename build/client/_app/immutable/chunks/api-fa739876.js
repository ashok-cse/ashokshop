import{l as w}from"./store-9c7a7cc1.js";import{i as E}from"./website-53ccb8f7.js";let a;const p=async({method:i,path:e,params:n,data:s,token:g,headers:c})=>{var h,y;if(e.includes(".png")||e.includes(".jpg")||e.includes(".svg")||e.includes(".json")||e.includes(".css")||e.includes("undefined"))return;const d={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0}.VITE_WWW_URL||"https://kitcommerce.tech";let l=d,T=E;c&&c.get("cookie")&&c.get("cookie").includes("store")&&(l=c.get("origin")||c.get("host"),l==="localhost:3000"?l="http://localhost:3000":l="https://"+l);let m=new URL(e,d);e.includes("/api/")||(m=new URL("api/"+e,l)),m.searchParams.get("domain"),m.searchParams.get("store");const f={method:i};if(f.headers=c||{Cache:"no-cache"},s){s.store=T;const t=(s==null?void 0:s.files)&&((h=s==null?void 0:s.files[0])==null?void 0:h.type);if(!(t=="image/jpeg"||t=="image/gif"||t=="image/png"||t=="image/ico"||t=="image/webp"||t=="application/pdf"||t=="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||t=="application/msword"||t=="application/vnd.openxmlformats-officedocument.wordprocessingml.document"))f.headers["Content-Type"]="application/json",f.body=JSON.stringify(s);else{const o=new FormData;if(s&&s.files)for(let u of s.files)o.append("files",u);for(let u in s)u!=="files"&&o.append(u,s[u]);f.body=o}}g&&(f.headers.Authorization=`Bearer ${g}`),n||(n={}),n&&Object.keys(n).forEach(t=>m.searchParams.append(t,n[t]));try{const t=m.toString();D();let o=await fetch(t,f);L();const r=((y=o.headers.get("content-type"))==null?void 0:y.includes("application/json"))?await o.json():await o.text();if((r==null?void 0:r.status)>399)throw{status:r.status,message:r};if((o==null?void 0:o.status)>399)throw{status:o.status,message:r};return r}catch(t){throw t}},R=(i,e)=>p({method:"GET",path:i,headers:e}),U=(i,e)=>p({method:"DELETE",path:i,headers:e}),W=(i,e,n)=>p({method:"POST",path:i,data:e,headers:n}),x=(i,e,n)=>p({method:"PUT",path:i,data:e,headers:n}),D=async()=>{clearTimeout(a),a=setTimeout(()=>{w.set(!0)},5e3)},L=async()=>{clearTimeout(a),w.set(!1)};export{x as a,U as d,R as g,W as p};
